# Put overrides to your pantheon.upstream.yml file here.
# For more information, see: https://pantheon.io/docs/pantheon-yml/
api_version: 1

web_docroot: true

# Drupal 9 requires PHP 7.3 or higher. If your code isn't ready for PHP 7.4 you may need to use 7.3 here:
php_version: 8.1

# Drupal 9 requires a higher version of the DB. It will take a few minutes to complete the upgrade to 10.4 once you push this file:
database:
  version: 10.4

# Add Pantheon Search
search:
  version: 8

# Add a comment to trigger a deploy on Pantheon
workflows:
  clear_cache:
    after:
      - type: webphp
        description: Post deployment notification to Slack
        script: private/scripts/slack_deploy_notification.php
  clone_database:
    after:
#      - type: webphp
#        description: Sanitize the db using a custom drush command
#        script: private/scripts/db_sanitization_portland.php
      - type: webphp
        description: Post deployment notification to Slack
        script: private/scripts/slack_deploy_notification.php
  create_cloud_development_environment:
    after:
      - type: webphp
        description: Post deployment notification to Slack
        script: private/scripts/slack_deploy_notification.php
  # The deployment event for Test and Live
  deploy:
    after:
      - type: webphp
        description: Run drush deploy
        script: private/scripts/drush_post_deploy.php
      - type: webphp
        description: Log deployment notification to New Relic
        script: private/scripts/new_relic_log_deployment.php
      - type: webphp
        description: Post deployment notification to Slack
        script: private/scripts/slack_deploy_notification.php
  # The deployment event for Dev and Multidevs
  sync_code:
    after:
      - type: webphp
        description: Log deployment notification to New Relic
        script: private/scripts/new_relic_log_deployment.php

